<odoo>
    <!-- Enhanced Mobile List View for Technicians -->
    <record id="view_workorder_mobile_list" model="ir.ui.view">
        <field name="name">maintenance.workorder.mobile.list</field>
        <field name="model">maintenance.workorder</field>
        <field name="priority" eval="20"/>
        <field name="arch" type="xml">
            <tree string="Work Orders (Mobile)" class="o_mobile_list">
                <field name="name"/>
                <field name="asset_id"/>
                <field name="building_id"/>
                <field name="state" widget="badge" decoration-info="state == 'draft'" decoration-warning="state == 'in_progress'" decoration-success="state == 'completed'" decoration-danger="state == 'cancelled'"/>
                <field name="priority" widget="badge" decoration-info="priority == '0'" decoration-warning="priority == '3'" decoration-danger="priority == '4'"/>
                <field name="sla_response_status" widget="badge" decoration-info="sla_response_status == 'on_time'" decoration-warning="sla_response_status == 'at_risk'" decoration-danger="sla_response_status == 'breached'"/>
                <field name="sla_resolution_status" widget="badge" decoration-info="sla_resolution_status == 'on_time'" decoration-warning="sla_resolution_status == 'at_risk'" decoration-danger="sla_resolution_status == 'breached'"/>
            </tree>
        </field>
    </record>

    <!-- Enhanced Mobile Form View for Technicians -->
    <record id="view_workorder_mobile_enhanced_form" model="ir.ui.view">
        <field name="name">maintenance.workorder.mobile.enhanced.form</field>
        <field name="model">maintenance.workorder</field>
        <field name="priority" eval="20"/>
        <field name="arch" type="xml">
            <form string="Work Order (Mobile)" class="o_mobile_form">
                <header>
                    <!-- Work Order Name - Prominently displayed with better spacing -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <h2 class="text-primary mb-0 text-center"><field name="name" readonly="1"/></h2>
                        </div>
                    </div>
                    
                    <!-- Work Order Status Overview - Simplified and better spaced -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <!-- Status overview container with improved spacing -->
                            <div class="row g-3">
                                <!-- Primary Status: Current work order state -->
                                <div class="col-6">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-header bg-primary text-white py-2">
                                            <small><i class="fa fa-tasks me-1"></i>Status</small>
                                        </div>
                                        <div class="card-body py-3">
                                            <field name="state" widget="selection" readonly="1"
                                                   decoration-info="state == 'draft'" 
                                                   decoration-warning="state == 'in_progress'" 
                                                   decoration-success="state == 'completed'" 
                                                   decoration-danger="state == 'cancelled'"/>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Priority Level: Read-only priority indicator -->
                                <div class="col-6">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-header bg-danger text-white py-2">
                                            <small><i class="fa fa-exclamation-triangle me-1"></i>Priority</small>
                                        </div>
                                        <div class="card-body py-3">
                                            <field name="priority" widget="selection" readonly="1" 
                                                   decoration-info="priority == '0'" 
                                                   decoration-warning="priority == '3'" 
                                                   decoration-danger="priority == '4'"/>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Work Order Type: Preventive, corrective, emergency, etc. -->
                                <div class="col-6">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-header bg-info text-white py-2">
                                            <small><i class="fa fa-wrench me-1"></i>Type</small>
                                        </div>
                                        <div class="card-body py-3">
                                            <field name="work_order_type" widget="selection" readonly="1"
                                                   decoration-info="work_order_type == 'preventive'" 
                                                   decoration-warning="work_order_type == 'corrective'" 
                                                   decoration-danger="work_order_type == 'emergency'"/>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Approval Status: Work order approval workflow state -->
                                <div class="col-6">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-header bg-warning text-white py-2">
                                            <small><i class="fa fa-check-circle me-1"></i>Approval</small>
                                        </div>
                                        <div class="card-body py-3">
                                            <field name="approval_state" widget="selection" readonly="1"
                                                   decoration-info="approval_state == 'draft'" 
                                                   decoration-warning="approval_state in ('submitted', 'supervisor')" 
                                                   decoration-success="approval_state == 'approved'" 
                                                   decoration-danger="approval_state == 'rejected'"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Schedule and Job Plan Information - Better spacing -->
                    <div class="row mb-4" invisible="not schedule_id">
                        <div class="col-12">
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-success text-white py-2">
                                    <small><i class="fa fa-calendar me-1"></i>Maintenance Schedule</small>
                                </div>
                                <div class="card-body py-3">
                                    <field name="schedule_id" readonly="1"/>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mb-4" invisible="not job_plan_id">
                        <div class="col-12">
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-info text-white py-2">
                                    <small><i class="fa fa-tasks me-1"></i>Job Plan</small>
                                </div>
                                <div class="card-body py-3">
                                    <field name="job_plan_id" readonly="1"/>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons - Better spacing and organization -->
                    <div class="d-flex flex-wrap gap-3 mb-4 justify-content-center">
                        <button name="action_start_progress" type="object" string="Start Work" class="btn btn-primary btn-lg"
                            invisible="state not in ('draft', 'assigned') or approval_state not in ('approved', 'draft', 'submitted', 'supervisor', 'manager')"
                            icon="fa-play"/>
                        <button name="action_quick_start" type="object" string="Quick Start" class="btn btn-success btn-lg"
                            invisible="state != 'draft' or approval_state != 'draft'"
                            icon="fa-bolt"/>
                        <button name="action_resume_work" type="object" string="Resume" class="btn btn-warning btn-lg"
                            invisible="state != 'on_hold'"
                            icon="fa-refresh"/>
                        <button name="action_complete" type="object" string="Complete" class="btn btn-success btn-lg"
                            invisible="state != 'in_progress'"
                            icon="fa-check"/>
                        <button name="action_stop_work" type="object" string="Stop Work" class="btn btn-danger btn-lg"
                            invisible="state != 'in_progress'"
                            icon="fa-stop"/>
                    </div>
                </header>

                <sheet>
                    <!-- SLA Status Section - Better spacing -->
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-header bg-secondary text-white">
                            <h5 class="mb-0"><i class="fa fa-clock me-2"></i>SLA Status</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-6">
                                    <field name="sla_response_status" widget="badge" readonly="1"/>
                                    <field name="sla_response_deadline" readonly="1"/>
                                </div>
                                <div class="col-6">
                                    <field name="sla_resolution_status" widget="badge" readonly="1"/>
                                    <field name="sla_resolution_deadline" readonly="1"/>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Asset Information Section -->
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="fa fa-cog me-2"></i>Asset Information</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-6">
                                    <field name="asset_id" readonly="1"/>
                                    <field name="facility_id" readonly="1"/>
                                </div>
                                <div class="col-6">
                                    <field name="building_id" readonly="1"/>
                                    <field name="room_id" readonly="1"/>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Work Order Details Section -->
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-header bg-info text-white">
                            <h5 class="mb-0"><i class="fa fa-info-circle me-2"></i>Work Order Details</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-6">
                                    <field name="description" readonly="1"/>
                                    <field name="technician_id" readonly="1"/>
                                </div>
                                <div class="col-6">
                                    <field name="start_date" readonly="1"/>
                                    <field name="end_date" readonly="1"/>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Time Tracking Section -->
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-header bg-warning text-white">
                            <h5 class="mb-0"><i class="fa fa-clock-o me-2"></i>Time Tracking</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-6">
                                    <field name="actual_start_date" readonly="state in ('completed', 'cancelled')"/>
                                    <field name="estimated_duration" readonly="1"/>
                                </div>
                                <div class="col-6">
                                    <field name="actual_end_date" readonly="state in ('draft', 'assigned', 'cancelled')"/>
                                    <field name="actual_duration" readonly="1"/>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Parts & Labor Section -->
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-header bg-secondary text-white">
                            <h5 class="mb-0"><i class="fa fa-wrench me-2"></i>Parts &amp; Labor</h5>
                        </div>
                        <div class="card-body">
                            <div class="row mb-3">
                                <div class="col-6">
                                    <field name="labor_cost" readonly="state in ('completed', 'cancelled')"/>
                                </div>
                                <div class="col-6">
                                    <field name="parts_cost" readonly="1"/>
                                </div>
                            </div>
                            <field name="parts_used_ids" readonly="state != 'in_progress'" nolabel="1">
                                <tree editable="bottom">
                                    <field name="product_id"/>
                                    <field name="quantity"/>
                                </tree>
                            </field>
                        </div>
                    </div>

                    <!-- Maintenance Tasks Section - Better spacing -->
                    <div class="card border-0 shadow-sm mb-4" invisible="work_order_type != 'preventive'">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0"><i class="fa fa-tasks me-2"></i>Maintenance Tasks</h5>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-info mb-3" role="alert" invisible="schedule_id and job_plan_id">
                                <i class="fa fa-info-circle me-2"></i>
                                <strong>Tasks are auto-generated from the job plan linked to this maintenance schedule.</strong>
                            </div>
                            
                            <div class="alert alert-warning mb-3" role="alert" invisible="schedule_id and job_plan_id">
                                <i class="fa fa-exclamation-triangle me-2"></i>
                                <strong>No job plan linked to this preventive workorder. Tasks are not available.</strong>
                                <p class="mb-0 mt-2">Please ensure the workorder has a linked maintenance schedule with a job plan to see tasks.</p>
                            </div>

                            <field name="workorder_task_ids" create="false" invisible="not (schedule_id and job_plan_id)">
                                <tree>
                                    <field name="section_id"/>
                                    <field name="name" readonly="1"/>
                                    <field name="description" readonly="1"/>
                                    <field name="is_done" widget="boolean_toggle" readonly="parent.state != 'in_progress'"/>
                                    <field name="before_image" widget="image" optional="show" string="Before"/>
                                    <field name="after_image" widget="image" optional="show" string="After"/>
                                    <button name="toggle_task_completion" type="object" string="Toggle" class="btn btn-secondary btn-sm" invisible="parent.state != 'in_progress'"/>
                                    <button name="action_view_task_mobile" type="object" string="Edit Task" class="btn btn-primary btn-sm"/>
                                    <button name="action_row_click_mobile" type="object" string="Open Task" class="btn btn-link btn-sm" invisible="1"/>
                                </tree>
                            </field>
                        </div>
                    </div>

                    <!-- Work Summary & Notes Section -->
                    <div class="card border-0 shadow-sm mb-4">
                        <div class="card-header bg-info text-white">
                            <h5 class="mb-0"><i class="fa fa-sticky-note me-2"></i>Work Summary &amp; Notes</h5>
                        </div>
                        <div class="card-body">
                            <field name="work_done" placeholder="Describe the work performed, issues found, and solutions applied..." readonly="state == 'cancelled'"/>
                            <div class="row mt-3">
                                <div class="col-6">
                                    <field name="first_time_fix" widget="boolean_toggle" readonly="state in ('draft', 'assigned', 'cancelled')"/>
                                </div>
                                <div class="col-6">
                                    <field name="service_type" readonly="state in ('completed', 'cancelled')"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Mobile Window Action for Work Orders -->
    <record id="action_maintenance_workorder_mobile" model="ir.actions.act_window">
        <field name="name">Work Orders (Mobile)</field>
        <field name="res_model">maintenance.workorder</field>
        <field name="view_mode">tree,form</field>
        <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('facilities_management.view_workorder_mobile_list')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('facilities_management.view_workorder_mobile_enhanced_form')})]"/>
        <field name="context">{'mobile_view': True}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first work order!
            </p>
            <p>
                Manage maintenance work orders with mobile-optimized interface for technicians.
            </p>
        </field>
    </record>

    <!-- Client action for enhanced mobile work orders -->
    <record id="action_maintenance_workorder_mobile_enhanced_client" model="ir.actions.client">
        <field name="name">Work Orders (Mobile Enhanced)</field>
        <field name="tag">mobile_workorders_enhanced</field>
        <field name="context">{}</field>
    </record>
</odoo>